# SafetyLayer Interface Design

## Goal Description
Implement the `SafetyLayer::clip` interface in C++. This layer acts as the "Envelope" in the user's "Envelope -> Data Spine -> Loop Wiring" architecture. It serves as a hard safety manifold, ensuring that actions never leave the safe region. The design mimics a torque-limited joint controller with clear distinctions between hard bounds (enforced clips) and soft warnings (logging).

## User Review Required
> [!IMPORTANT]
> **Safety Contract**: The [clip](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/src/safety/SafetyLayer.cpp#9-83) function returns a [ClipResult](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp#74-79) that explicitly states if the action was modified. The caller *must* respect the `clamped_action` in the result.

## Proposed Changes

### Structure
Creating a standard C++ project structure:
- [include/safety/SafetyLayer.hpp](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp): The core interface definition.
- [src/safety/SafetyLayer.cpp](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/src/safety/SafetyLayer.cpp): Implementation (placeholder for now).

### [SafetyLayer](file:///include/safety/SafetyLayer.hpp)
The header will define:
- **Enums**: `ViolationType` (None, SoftLimit, HardLimit, InvariantBreach).
- **Structs**:
    - [SafetyBounds](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp#40-42): Defines min/max for hard and soft limits.
    - [Action](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp#47-51): A generic representation of the control signal (e.g., torque/velocity).
    - [ClipStats](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp#63-70): Telemetry struct for what happened (logged, blocked, TQ passed).
- **Class**: [SafetyLayer](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/safety/SafetyLayer.hpp#84-100)
    - Method: [clip(const Action& proposed, const State& context) -> ClipResult](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/src/safety/SafetyLayer.cpp#9-83)
    - Invariants: Documented as generally applicable rules (e.g., $|u| \le u_{max}$).

## Verification Plan
### Automated Tests
- Create a simple main.cpp driver to compile against the header and verify struct sizes/alignments if necessary.
- Unit tests to pass signals through [clip](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/src/safety/SafetyLayer.cpp#9-83) and assert:
    - Signals inside soft bounds are untouched.
    - Signals between soft and hard bounds trigger warnings but pass (or are damped, depending on "soft warning" interpretation - usually just warning, but user said "torque-limited", implying potential soft-capping. I will assume soft warnings are just flags/logs for now unless "torque-limited" implies spring-damper behavior near limits. Re-reading: "hard bounds, soft warnings" -> likely just reporting).
    - Signals outside hard bounds are clamped.

### Manual Verification
- Review the generated header file against the user's specific "zero-ambiguity" requirement.

# Orchestrator Agent Implementation

## Goal Description
Create the "Orchestrator Model" as a formal Agent within the system. This involves:
1.  **C++ Implementation**: `agents::OrchestratorAgent` that embodies the MoE Kernel logic (Assembly Actuator, Integrity Expert) within the simulation loop.
2.  **ADK Definition**: `adk/agents/orchestrator.v0.json` declaring the agent's lineage and compliance.

## Proposed Changes

### [OrchestratorAgent](file:///include/agents/OrchestratorAgent.hpp)
- **Class**: `OrchestratorAgent`
- **Responsibilities**:
    - Monitor [WorldModel](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/include/engine/WorldModel.hpp#18-19) state.
    - Execute `SafetyLayer::clip` on other agents (mocked or actual).
    - Enforce "Petrified" status.

### [Agent Capsule](file:///adk/agents/orchestrator.v0.json)
- **Schema**: logic derived from [agent_capsule.v0.json](file:///C:/Users/eqhsp/.gemini/antigravity/playground/ghost-void/adk/schemas/agent_capsule.v0.json).
- **Metadata**: Connects the agent to the specific `assembly_actuator` contract.

